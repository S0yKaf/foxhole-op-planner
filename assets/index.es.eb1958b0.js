import{r as v,w as F,o as Q,a as G,b as m,d as W,i as I,c as A,e as X,f as Y,g as Z,n as ee,u as r}from"./entry.196be917.js";const w=Symbol(),P=v(!1),S=v(!1),O=v(!1),T=v(0);let C=null;const ne=()=>{const n=document.createElement("script");return n.src="https://accounts.google.com/gsi/client",n.async=!0,n.defer=!0,n},oe=()=>{S.value=!0,C=ne(),document.head.appendChild(C),C.onload=()=>{S.value=!1,P.value=!0},C.onerror=()=>{S.value=!1,O.value=!0}};F(()=>T.value,(n,o)=>{n>0&&!P.value&&!S.value&&oe()});function x(){return Q(()=>{T.value++}),G(()=>{T.value--}),{scriptLoaded:m(P),scriptLoadError:m(O)}}const te=W({__name:"GoogleSignInButton",props:{oneTap:{type:Boolean},autoSelect:{type:Boolean},loginUri:null,cancelOnTapOutside:{type:Boolean},promptParentId:null,nonce:null,context:null,stateCookieDomain:null,uxMode:null,allowedParentOrigin:null,itpSupport:{type:Boolean},type:null,theme:null,size:null,text:null,shape:null,logoAlignment:null,width:null,locale:null},emits:["success","error","intermediateIframeCloseCallback","nativeCallback","promptMomentNotification"],setup(n,{emit:o}){const e=n,t={large:40,medium:32,small:20},l=I(w),s=v(null),{scriptLoaded:g}=x();A(()=>{var a,i,d,p;g.value&&((a=window.google)==null||a.accounts.id.initialize({client_id:l,callback:c=>{if(!c.clientId||!c.credential){o("error");return}o("success",c)},allowed_parent_origin:e.allowedParentOrigin,auto_select:e.autoSelect,cancel_on_tap_outside:e.cancelOnTapOutside,context:e.context,intermediate_iframe_close_callback:()=>{o("intermediateIframeCloseCallback")},itp_support:e.itpSupport,login_uri:e.loginUri,native_callback:c=>{o("nativeCallback",c)},nonce:e.nonce,prompt_parent_id:e.promptParentId,state_cookie_domain:e.stateCookieDomain,ux_mode:e.uxMode}),(d=window.google)==null||d.accounts.id.renderButton(s.value,{type:e.type,theme:e.theme,size:e.size,text:e.text,shape:e.shape,logo_alignment:e.logoAlignment,width:(i=e.width)==null?void 0:i.toString(),locale:e.locale}),e.oneTap&&((p=window.google)==null||p.accounts.id.prompt(c=>{o("promptMomentNotification",c)})))}),G(()=>{var a;e.oneTap&&((a=window.google)==null||a.accounts.id.cancel())});const u=X(()=>t[e.size||"large"]);return(a,i)=>(Y(),Z("div",{ref_key:"targetElement",ref:s,style:ee({display:"inline-flex",height:r(u)})},null,4))}});function ce(n,o,...e){var t;return((t=window.google)==null?void 0:t.accounts.oauth2.hasGrantedAllScopes(n,o,...e))||!1}function re(n,o,...e){var t;return((t=window.google)==null?void 0:t.accounts.oauth2.hasGrantedAnyScope(n,o,...e))||!1}function se(n,o){var e;(e=window.google)==null||e.accounts.oauth2.revoke(n,()=>{o==null||o()})}function le(n){const o="https://accounts.google.com/o/oauth2/v2/auth",e=new URLSearchParams({gsiwebsdk:"3",client_id:n.client_id,scope:n.scope,include_granted_scopes:"true",access_type:"offline",response_type:"code",prompt:"consent"});return n.hint&&e.append("hint",n.hint),n.hosted_domain&&e.append("hosted_domain",n.hosted_domain),n.redirect_uri===void 0?e.append("redirect_uri",window.origin):e.append("redirect_uri",n.redirect_uri),n.select_account===void 0?e.append("select_account","false"):e.append("select_account",`${n.select_account}`),n.enable_serial_consent===void 0?e.append("enable_serial_consent","false"):e.append("enable_serial_consent",`${n.enable_serial_consent}`),n.state&&e.append("state",n.state),`${o}?${e.toString()}`}function ue(n={}){const{scope:o="",onError:e,onSuccess:t,...l}=n,{scriptLoaded:s}=x(),g=I(w),u=v(!1),a=v(null);let i;return A(()=>{var d;if(u.value=!1,!s.value)return;const p=r(o),h=`openid email profile ${Array.isArray(p)?p.join(" "):p}`;a.value=le({client_id:g,scope:h,...l}),i=(d=window.google)==null?void 0:d.accounts.oauth2.initCodeClient({client_id:g,scope:h,callback:f=>{if(f.error)return e==null?void 0:e(f);t==null||t(f)},...l}),u.value=!0}),{isReady:m(u),login:()=>i==null?void 0:i.requestCode(),codeRequestRedirectUrl:m(a)}}function de(n){const{disableAutomaticPrompt:o=!1,onSuccess:e,onError:t,onPromptMomentNotification:l,onNativeCallback:s,onIntermediateIframeCloseCallback:g,autoSelect:u,loginUri:a,cancelOnTapOutside:i,promptParentId:d,nonce:p,context:c,stateCookieDomain:h,allowedParentOrigin:f,itpSupport:R}=n||{},{scriptLoaded:z}=x(),B=I(w),b=v(!1),L=()=>{var y;return b.value&&((y=window.google)==null?void 0:y.accounts.id.prompt(k=>l==null?void 0:l(k)))};return A(y=>{var k,E;if(b.value=!1,!z.value)return;const $=!r(o),q=r(u),M=r(a),N=r(d),j=r(p),V=r(c),D=r(h),H=r(f),J=r(R),K=r(i);(k=window.google)==null||k.accounts.id.initialize({client_id:B,callback:_=>{if(console.log("cb triggered"),!_.clientId||!_.credential){t==null||t();return}e==null||e(_)},native_callback:_=>{s==null||s(_)},intermediate_iframe_close_callback:()=>{g==null||g()},auto_select:q,allowed_parent_origin:H,context:V,itp_support:J,login_uri:M,nonce:j,prompt_parent_id:N,state_cookie_domain:D,cancel_on_tap_outside:K}),b.value=!0,$&&((E=window.google)==null||E.accounts.id.prompt(_=>l==null?void 0:l(_))),y(()=>{var _;(_=window.google)==null||_.accounts.id.cancel()})}),{isReady:m(b),login:L}}function pe(n={}){const{scope:o="",onError:e,onSuccess:t,...l}=n,{scriptLoaded:s}=x(),g=I(w),u=v(!1);let a;return A(()=>{var i;if(u.value=!1,!s.value)return;const d=r(o),p=Array.isArray(d)?d.join(" "):d;a=(i=window.google)==null?void 0:i.accounts.oauth2.initTokenClient({client_id:g,scope:`openid email profile ${p}`,callback:c=>{if(c.error)return e==null?void 0:e(c);t==null||t(c)},...l}),u.value=!0}),{isReady:m(u),login:i=>a==null?void 0:a.requestAccessToken(i)}}function _e(n,o){var e;(e=window.google)==null||e.accounts.id.revoke(n,t=>{o==null||o(t)})}function ge(n){const e=n.split(".")[1].replace(/-/g,"+").replace(/_/g,"/"),t=decodeURIComponent(window.atob(e).split("").map(s=>`%${("00"+s.charCodeAt(0).toString(16)).slice(-2)}`).join("")),l=JSON.parse(t);return{email:l.email,email_verified:l.email_verified,hd:l.hd,family_name:l.family_name,given_name:l.given_name,name:l.name,picture:l.picture,id:l.sub}}const ae="GoogleSignInPlugin",U=n=>`[${ae}]: ${n}`,ve={install(n,o){if(!o)throw new Error(U("initialize plugin by passing an options object"));if(!o.clientId||o.clientId&&o.clientId.trim().length===0)throw new Error(U("clientId is required to initialize"));n.provide(w,o.clientId),n.component("GoogleSignInButton",te)}};export{te as GoogleSignInButton,ae as PLUGIN_NAME,le as buildCodeRequestRedirectUrl,ge as decodeCredential,ve as default,ce as hasGrantedAllScopes,re as hasGrantedAnyScopes,_e as idRevoke,se as revokeAccessToken,ue as useCodeClient,x as useGsiScript,de as useOneTap,pe as useTokenClient};
